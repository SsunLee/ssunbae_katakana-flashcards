(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{63:(e,r,t)=>{"use strict";var a=t(7260);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},448:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(1847).A)("circle-user-round",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},1847:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var a=t(2115);let n=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},s=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:u,...f}=e;return(0,a.createElement)("svg",{ref:r,...l,width:n,height:n,stroke:t,strokeWidth:i?24*Number(o)/Number(n):o,className:s("lucide",c),...!d&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(f)&&{"aria-hidden":"true"},...f},[...u.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(d)?d:[d]])}),i=(e,r)=>{let t=(0,a.forwardRef)((t,l)=>{let{className:i,...c}=t;return(0,a.createElement)(o,{ref:l,iconNode:r,className:s("lucide-".concat(n(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return t.displayName=n(e),t}},2171:(e,r,t)=>{"use strict";t.d(r,{$:()=>c,r:()=>i});var a=t(5155),n=t(2115),s=t(2467),l=t(3101),o=t(8456);let i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,r)=>{let{className:t,variant:n,size:l,asChild:c=!1,...d}=e,u=c?s.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(i({variant:n,size:l,className:t})),ref:r,...d})});c.displayName="Button"},5190:(e,r,t)=>{"use strict";let a;t.d(r,{QF:()=>f,db:()=>u,j2:()=>d,yA:()=>c});var n=t(2078),s=t(3885),l=t(9708),o=t(2587),i=t(8134);let c=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyDThv_Wl4448hturEyXLfqRTXNRT1DU7pQ",authDomain:"ssunbae-kana.firebaseapp.com",projectId:"ssunbae-kana",storageBucket:"ssunbae-kana.firebasestorage.app",messagingSenderId:"145214567765",appId:"1:145214567765:web:e7f75bdfcdb35a2d382bdc"});try{let e="function"==typeof o.Ii.isNativePlatform?o.Ii.isNativePlatform():"web"!==o.Ii.getPlatform();a=(0,s.Nu)(c,{persistence:e?s.Gt:s.F0})}catch(e){a=(0,s.xI)(c)}let d=a,u=(0,l.aU)(c);(0,i.c7)(c);let f=async()=>{if(!d.currentUser)try{"undefined"!=typeof __initial_auth_token&&__initial_auth_token&&(await (0,s.p)(d,__initial_auth_token),console.log("Custom token으로 인증 성공!"))}catch(e){console.error("Custom token 인증 실패:",e)}}},6185:(e,r,t)=>{"use strict";t.d(r,{BT:()=>c,Wu:()=>d,ZB:()=>i,Zp:()=>l,aR:()=>o,wL:()=>u});var a=t(5155),n=t(2115),s=t(8456);let l=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});l.displayName="Card";let o=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...n})});o.displayName="CardHeader";let i=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});i.displayName="CardTitle";let c=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...n})});d.displayName="CardContent";let u=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...n})});u.displayName="CardFooter"},6287:(e,r,t)=>{Promise.resolve().then(t.bind(t,6747))},6747:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>v});var a=t(5155),n=t(2115),s=t(63),l=t(9070),o=t(2171),i=t(8456);let c=n.forwardRef((e,r)=>{let{className:t,type:n,...s}=e;return(0,a.jsx)("input",{type:n,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...s})});c.displayName="Input";var d=t(6185),u=t(1847);let f=(0,u.A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var h=t(448);let m=(0,u.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var p=t(5190),g=t(3885);function v(){let{user:e,refreshUser:r,loading:t}=(0,l.A)(),i=(0,s.useRouter)(),[u,v]=(0,n.useState)(""),[x,b]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t||e||i.replace("/"),e&&v(e.nickname||"")},[e,t,i]);let y=async()=>{if(console.log("--- [handleSave] 닉네임 저장 시작 ---"),!e||!p.j2.currentUser)return void console.error("[handleSave] Error: 유저 또는 auth.currentUser가 없습니다.");b(!0);try{console.log("[handleSave] 1. ID 토큰 요청 시작");let e=await (0,g.p9)(p.j2.currentUser,!0);console.log("[handleSave] 2. ID 토큰 발급 성공");let t={nickname:u};console.log("[handleSave] 3. API 요청 시작. Body:",JSON.stringify(t));let a=await fetch("/api/profile",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)});if(console.log("[handleSave] 4. API 응답 받음. Status: ".concat(a.status)),!a.ok){let e=await a.json().catch(()=>({error:"서버 응답 파싱 실패"}));throw console.error("[handleSave] API Error Response:",e),Error(e.error||"프로필 업데이트 실패: ".concat(a.statusText))}console.log("[handleSave] 5. API 호출 성공. refreshUser 호출 시작"),await r({nickname:u}),console.log("[handleSave] 6. refreshUser 호출 완료"),alert("닉네임이 성공적으로 업데이트되었습니다!")}catch(e){console.error("!!! [handleSave] CATCH 블록에서 에러 발생 !!!",e),alert(e.message||"오류가 발생했습니다. 다시 시도해주세요.")}finally{b(!1),console.log("--- [handleSave] 닉네임 저장 종료 ---")}};return t||!e?(0,a.jsx)("div",{children:"Loading..."}):(0,a.jsx)("div",{className:"min-h-screen bg-background text-foreground p-4 sm:p-6 lg:p-8",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(o.$,{variant:"outline",size:"icon","aria-label":"Go Back",onClick:()=>i.back(),children:(0,a.jsx)(f,{className:"h-4 w-4"})})}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{className:"text-2xl",children:"프로필 설정"}),(0,a.jsx)(d.BT,{children:"닉네임을 변경할 수 있습니다."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(h.A,{className:"w-24 h-24 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"nickname",className:"text-sm font-medium",children:"닉네임"}),(0,a.jsx)(c,{id:"nickname",value:u,onChange:e=>v(e.target.value),placeholder:"새 닉네임을 입력하세요"})]})]}),(0,a.jsx)(d.wL,{children:(0,a.jsxs)(o.$,{className:"w-full",onClick:y,disabled:x,children:[x?(0,a.jsx)(m,{className:"w-4 h-4 mr-2 animate-spin"}):null,"변경사항 저장"]})})]})]})})}},8456:(e,r,t)=>{"use strict";t.d(r,{cn:()=>s});var a=t(2821),n=t(5889);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.QP)((0,a.$)(r))}},9070:(e,r,t)=>{"use strict";t.d(r,{A:()=>d,O:()=>c});var a=t(5155),n=t(2115),s=t(3885),l=t(9708),o=t(5190);let i=(0,n.createContext)({user:null,loading:!0,refreshUser:async()=>{}});function c(e){let{children:r}=e,[t,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(!0),f=(0,s.xI)(o.yA),h=(0,n.useCallback)(async e=>{if(e){let t=(0,l.H9)(o.db,"users",e.uid),a=await (0,l.x7)(t);if(a.exists()){let r=a.data();c({uid:e.uid,email:e.email,nickname:r.nickname||e.displayName,photoURL:r.photoURL||e.photoURL})}else{var r;c({uid:e.uid,email:e.email,nickname:e.displayName||(null==(r=e.email)?void 0:r.split("@")[0])||"사용자",photoURL:e.photoURL})}}else c(null);u(!1)},[]);(0,n.useEffect)(()=>{let e=(0,s.hg)(f,e=>{h(e)});return()=>e()},[f,h]);let m=(0,n.useCallback)(async e=>{if(e){console.log("[AuthContext] 낙관적 업데이트 실행:",e),c(r=>r?{...r,...e}:null);return}console.log("[AuthContext] 서버로부터 데이터 동기화 시작");let r=f.currentUser;r&&(await r.reload(),await h(r),console.log("[AuthContext] 서버 동기화 완료"))},[f,h]);return(0,a.jsx)(i.Provider,{value:{user:t,loading:d,refreshUser:m},children:r})}let d=()=>(0,n.useContext)(i)}},e=>{e.O(0,[2992,7811,5707,3938,8441,1255,7358],()=>e(e.s=6287)),_N_E=e.O()}]);